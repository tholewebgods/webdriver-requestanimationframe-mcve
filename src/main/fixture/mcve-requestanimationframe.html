<!doctype html>
<html>
<head>
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
	<style>
		#target {
			outline: 1px solid #000;
			visibility: hidden;
		}
		#target.done {
			visibility: visible;
		}
	</style>
</head>
<body>
<button>Click me</button>
<div id="target">Target</div>
<pre id="log">
</pre>
<script>
function log(s) {
	document.querySelector("#log").textContent += new Date() + ": " + s + "\n";
}
document.querySelector("button").addEventListener("click", () => {
	log("Start timeout");
	setTimeout(() => {
		log("Queue requestAnimationFrame");
		requestAnimationFrame(() => {
			log("requestAnimationFrame called");
			document.querySelector("#target").classList.add("done");
		});
	}, 1000);
});
</script>
</body>
</html>
